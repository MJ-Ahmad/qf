<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Payment — Quraner Fariwala</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <div class="nav">
      <a class="brand" href="./index.html">
        <div class="logo" aria-hidden="true">ق</div>
        <div><div class="brand-title">Quraner Fariwala</div></div>
      </a>
    </div>
  </header>

  <main class="container">
    <h1>Payment Instructions</h1>

    <div id="payment-invoice" class="card" style="padding:1rem;margin-top:1rem">
      <!-- Invoice summary rendered by inline script -->
    </div>

    <section class="card" style="margin-top:1rem;padding:1rem">
      <h2>Payment Options</h2>

      <div style="display:flex;flex-direction:column;gap:0.75rem">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-weight:800">Bkash (Personal)</div>
            <div class="small">Number: <span id="bkash-number">+8801XXXXXXXXX</span></div>
          </div>
          <div style="display:flex;gap:0.5rem">
            <button class="btn-ghost copy-btn" data-copy="+8801XXXXXXXXX">Copy</button>
          </div>
        </div>

        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-weight:800">Bank Transfer</div>
            <div class="small">Account: <span id="bank-account">0123456789012</span> — <span id="bank-name">Example Bank</span></div>
            <div class="small">Account name: Quraner Fariwala Ltd</div>
          </div>
          <div style="display:flex;gap:0.5rem">
            <button class="btn-ghost copy-btn" data-copy="0123456789012">Copy</button>
          </div>
        </div>

        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-weight:800">International USD Wire</div>
            <div class="small">IBAN / SWIFT will be provided on request</div>
          </div>
          <div style="display:flex;gap:0.5rem">
            <button class="btn-ghost" onclick="alert('Please contact quranerfariwala@gmail.com for USD wire details')">Request</button>
          </div>
        </div>
      </div>

      <div class="small" style="margin-top:0.75rem;color:var(--muted)">
        After you complete the manual payment, click <strong>Confirm Payment</strong> and paste the transaction/reference ID. We will mark your invoice as <strong>paid</strong> locally and show the updated invoice.
      </div>

      <div style="margin-top:1rem;display:flex;gap:0.5rem">
        <button id="confirm-payment" class="full-btn">Confirm Payment</button>
        <a href="./checkout.html" class="btn-ghost">Edit</a>
      </div>
    </section>

    <section style="margin-top:1rem" class="card">
      <h3>How to confirm</h3>
      <ol class="small">
        <li>Choose a payment option and complete the transfer using the provided details.</li>
        <li>Copy or note the transaction/reference ID from your payment receipt.</li>
        <li>Click Confirm Payment and paste the transaction ID when prompted.</li>
        <li>After confirmation you will be redirected to the Invoice page where status will show Paid.</li>
      </ol>
    </section>
  </main>

  <footer>
    <div class="footer-inner small">© 2026 Quraner Fariwala</div>
  </footer>

  <div id="qf-toast" aria-hidden="true"></div>
  <script src="js/script.js"></script>

  <script>
    (function(){
      const LAST_ORDER_KEY = 'qf_last_order';
      function safeParse(v, fallback = null) { try { return JSON.parse(v); } catch { return fallback; } }
      function formatCurrency(n) { const num = Number(n||0); if(!Number.isFinite(num)) return '$0.00'; return '$'+num.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2}); }

      const invoiceEl = document.getElementById('payment-invoice');
      const BKASH = '+88017XXXXXXXX';
      const BANK = '0123456789012';
      const BANK_NAME = 'Example Bank';
      document.getElementById('bkash-number').textContent = BKASH;
      document.getElementById('bank-account').textContent = BANK;
      document.getElementById('bank-name').textContent = BANK_NAME;

      function loadOrder() { return safeParse(localStorage.getItem(LAST_ORDER_KEY), null); }
      function render() {
        const order = loadOrder();
        if (!order) { invoiceEl.innerHTML = '<div class="small">No pending invoice found. Start from Donate page.</div>'; return; }
        const itemsHtml = (order.items || []).map(it => `<div style="display:flex;justify-content:space-between;padding:6px 0"><div>${(it.title)}</div><div>${formatCurrency(it.price)}</div></div>`).join('');
        invoiceEl.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div><strong>Order ID:</strong> ${order.id}</div>
              <div class="small">Donor: ${order.donor?.name || ''} • ${order.donor?.phone || ''}</div>
            </div>
            <div style="text-align:right">
              <div style="font-weight:800">${formatCurrency(order.total)}</div>
              <div class="small" style="margin-top:6px">Status: <strong style="color:${order.status==='paid'?'var(--success)':'var(--warning)'}">${order.status}</strong></div>
            </div>
          </div>
          <div style="margin-top:12px">${itemsHtml}</div>
        `;
      }

      // copy buttons handled by global script
      render();
    })();
  </script>
</body>
</html>
